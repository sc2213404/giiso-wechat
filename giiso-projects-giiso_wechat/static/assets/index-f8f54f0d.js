import{a as f,e as v}from"./chat-81d2b5f2.js";import{u as y,r as I,m as g,n as S,a as T,o as $,c as b,b as a,t as l,e as d,d as A,w as N,f as k,s as C,v as L,q,x as B}from"./index-19d99aad.js";const D={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},U={class:"w-full max-w-md space-y-6"},V={class:"text-center text-lg font-medium text-gray-900"},P={class:"bg-white rounded-lg p-6 space-y-4"},z={class:"space-y-2"},E={class:"text-gray-600"},G={class:"text-gray-900"},M={class:"space-y-2"},W=a("div",{class:"text-gray-600"},"AI智能体：",-1),F={class:"text-gray-900"},O={__name:"index",setup(H){const{proxy:n}=q(),u=y(),s={wxuin:localStorage.getItem("wxuin"),wxname:localStorage.getItem("wxname")},m=I({}),x=async()=>{try{const e=await C({wxuin:s.wxuin});console.log(e),e.code==0?m.value=e.data:n.$router.push("/login")}catch{}};g(()=>{x()});let c=null,i=null;const r=()=>{c&&(clearInterval(c),c=null,i=null)},p=()=>{r(),i=new Date().getTime(),c=setInterval(()=>{f().then(e=>{if(e.code==200)if(e.data.alive===!0){let o=new Date().getTime();o-i>6e4&&(L({type:"1",wxuin:s.wxuin,wxname:s.wxname}),i=o)}else n.$notification.warning({id:"notice-alive",title:"Notification",content:"当前账号已离线，请重新登录",closable:!0,duration:0}),r(),n.$router.replace("/qrcode");else n.$message.error("查询在线状态失败")})},5e3)};g(()=>{console.log("页面加载"),p()}),S(()=>{console.log("页面卸载"),r()});const _=()=>new Promise((e,o)=>{v().then(t=>{t.code==200?e(t):o(t)}).catch(t=>{o(t)})}),h=()=>new Promise((e,o)=>{B({wxuin:s.wxuin}).then(t=>{t.code==0?e(t):o(t)}).catch(t=>{o(t)})}),w=async()=>{try{await _(),await h(),localStorage.removeItem("token"),localStorage.removeItem("wxuin"),localStorage.removeItem("wxname"),n.$message.success("退出成功"),n.$router.push("/qrcode")}catch{n.$message.error("退出失败")}};return(e,o)=>{const t=T("a-button");return $(),b("div",D,[a("div",U,[a("h1",V," 正在托管"+l(d(u).clientType)+"账号 ",1),a("div",P,[a("div",z,[a("div",E,l(d(u).clientType)+"账号：",1),a("div",G,l(s.wxname||"--"),1)]),a("div",M,[W,a("div",F,l(d(m).appName||"--"),1)])]),A(t,{type:"primary",size:"large",long:"",onClick:w},{default:N(()=>[k(" 退出登录 ")]),_:1})])])}}};export{O as default};
